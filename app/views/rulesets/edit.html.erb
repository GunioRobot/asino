<%= render :partial => 'layouts/sidebar' %>

<div class="column right">
<h1>Regel bearbeiten</h1>

<% form_for(@ruleset) do |f| %>
  <%= f.error_messages %>

  <p>
    <%= f.label :name %><br />
    <%= f.text_field :name %> <%= f.check_box :active %> <%= f.label :active, 'Regel ist aktiv' %>
  </p>
  <p>
    <%= f.label :account_id, 'Gilt für: ' %> 
    <%= f.collection_select(:account_id, Account.all(:order => 'title'), 
										:id, :title, {:include_blank => 'Alle Konten'}) %>
  </p>
  <p>
	<%= f.label :action, 'Aktion: ' %>
	<%= f.select :action, [['Kategorie zuweisen', 'set_category']]%>
	<span>
	    <%= f.collection_select(:action_parameter, Category.all(:order => 'name', :conditions => "category_id is NULL"), 
											:id, :name) %>
	</span>
  </p>
  <p>
    <%= f.submit 'Speichern' %>
  </p>
<% end %>

  <% unless @ruleset.rules.empty? %><h3>Die Regel wird ausgeführt, wenn</h3><% end %>
  <div class="m20">
	<% @ruleset.rules.each do |rule| %>
	  <div id="rule_<%= rule.id %>">
	    <%= render :partial => 'rules/edit', :locals => {:rule => rule} %>
	    <%= "<h3>oder</h3>" unless @ruleset.rules.size == 1 or rule == @ruleset.rules.last %>
	  </div>
	<% end %>
	<h3>Neue Bedingung hinzufügen:</h3>
	<%= render :partial => 'rules/new', :locals => {:ruleset => @ruleset} %>
  </div>
</div>



<div class="clr"> </div>
